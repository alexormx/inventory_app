<div class="container py-4 product-show" data-controller="productMeta">
  <div class="row gy-4">
    <div class="col-lg-6">
      <% if @product.product_images.attached? %>
        <%= render 'products/gallery', product: @product %>
      <% else %>
        <%= image_tag 'placeholder.png', class: 'w-100 rounded shadow-sm', alt: 'Imagen no disponible' %>
      <% end %>
    </div>
    <div class="col-lg-6 col-xl-5 offset-xl-1">
      <%= render 'products/summary_panel', product: @product %>
    </div>
  </div>

  <div class="row mt-5 g-4">
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm" id="descripcion" data-product-description>
        <div class="card-body">
          <h2 class="h5 fw-semibold mb-3"><i class="fas fa-align-left text-primary me-2"></i>Descripción</h2>
          <p class="text-muted mb-0"><%= @product.description.presence || 'Este producto no tiene una descripción disponible por el momento.' %></p>
        </div>
      </div>

      <div class="card border-0 shadow-sm mt-4" id="detalles">
        <div class="card-body">
          <h2 class="h5 fw-semibold mb-3"><i class="fas fa-list-alt text-primary me-2"></i>Detalles</h2>
          <% if @product.custom_attributes.present? %>
            <div class="row row-cols-1 row-cols-sm-2 g-3 small">
              <% @product.parsed_custom_attributes.each do |key, value| %>
                <div class="col d-flex">
                  <div class="w-50 text-muted text-capitalize"><%= key %></div>
                  <div class="flex-grow-1 fw-medium"><%= value %></div>
                </div>
              <% end %>
            </div>
          <% else %>
            <p class="text-muted small mb-0">No hay detalles adicionales.</p>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-lg-4 d-none d-lg-block"><!-- espacio lateral futuro (relacionados, reviews) --></div>
  </div>
</div>

<style>
.product-show .product-gallery .gallery-viewport{overflow:hidden;border-radius:.5rem}
.product-show .gallery-track{display:flex;transition:transform .45s cubic-bezier(.4,.1,.2,1)}
.product-show .gallery-slide{flex:0 0 100%;padding:2px}
.product-show .gallery-nav{position:absolute;top:50%;transform:translateY(-50%);background:#fff;border:0;border-radius:50%;width:36px;height:36px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(0,0,0,.15);cursor:pointer;font-size:20px;color:#444}
.product-show .gallery-nav.prev{left:8px}.product-show .gallery-nav.next{right:8px}
.product-show .gallery-thumbs .thumbnail-image{width:72px;height:72px;object-fit:cover}
.product-summary{position:sticky;top:calc(var(--banner-height,0px) + var(--nav-height,60px) + 1rem)}
.product-summary .line-clamp{-webkit-line-clamp:3;-webkit-box-orient:vertical;display:-webkit-box;overflow:hidden}
@media (max-width: 991px){.product-summary{position:static}}
</style>
