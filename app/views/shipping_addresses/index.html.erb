<h1 class="mb-3">ğŸ“¦ Mis direcciones</h1>
<div class="row">
  <div class="col-md-6">
    <h5 class="mb-2">Guardadas</h5>
    <% if @addresses.any? %>
      <ul class="list-group mb-4">
        <% @addresses.each do |addr| %>
          <li class="list-group-item d-flex justify-content-between align-items-start">
            <div>
              <strong><%= addr.label %></strong>
              <% if addr.default? %><span class="badge bg-success ms-1">Default</span><% end %><br>
              <small><%= addr.full_name %></small><br>
              <small class="text-muted"><%= addr.to_one_line %></small>
            </div>
            <div class="ms-2 d-flex flex-column gap-1 align-items-end">
              <%= link_to 'Editar', edit_shipping_address_path(addr), class: 'btn btn-sm btn-outline-secondary' %>
              <% unless addr.default? %>
                <%= button_to 'Default', make_default_shipping_address_path(addr), method: :patch, class: 'btn btn-sm btn-outline-primary' %>
              <% end %>
              <%= button_to 'Eliminar', shipping_address_path(addr), method: :delete, data: { turbo_confirm: 'Â¿Eliminar direcciÃ³n?' }, class: 'btn btn-sm btn-outline-danger' %>
            </div>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted">No tienes direcciones guardadas.</p>
    <% end %>
  </div>
  <div class="col-md-6">
    <h5 class="mb-2">Agregar nueva</h5>
    <%= form_with model: @address, local: true do |f| %>
      <% if params[:return_to].present? %>
        <%= hidden_field_tag :return_to, params[:return_to] %>
      <% end %>
      <div class="row g-2">
        <div class="col-6">
          <%= f.label :label, 'Etiqueta' %>
          <%= f.text_field :label, class: 'form-control', placeholder: 'Casa / Oficina' %>
        </div>
        <div class="col-6">
          <%= f.label :full_name, 'Nombre' %>
          <%= f.text_field :full_name, class: 'form-control', required: true %>
        </div>
        <div class="col-12">
          <%= f.label :line1, 'DirecciÃ³n (lÃ­nea 1)' %>
          <%= f.text_field :line1, class: 'form-control', required: true %>
        </div>
        <div class="col-12">
          <%= f.label :line2, 'DirecciÃ³n (lÃ­nea 2)' %>
          <%= f.text_field :line2, class: 'form-control' %>
        </div>
        <div class="col-6">
          <%= f.label :city, 'Ciudad' %>
          <%= f.text_field :city, class: 'form-control', required: true %>
        </div>
        <div class="col-6">
          <%= f.label :state, 'Estado' %>
          <%= f.text_field :state, class: 'form-control' %>
        </div>
        <div class="col-6">
          <%= f.label :postal_code, 'CP' %>
          <%= f.text_field :postal_code, class: 'form-control', required: true %>
        </div>
        <div class="col-6">
          <%= f.label :country, 'PaÃ­s' %>
          <%= f.text_field :country, class: 'form-control', value: 'MX', required: true %>
        </div>
        <div class="col-12 form-check mt-1">
          <%= f.check_box :default, class: 'form-check-input', id: 'addr_default' %>
          <%= f.label :default, 'Establecer como predeterminada', class: 'form-check-label' %>
        </div>
        <div class="col-12 text-end">
          <%= f.submit 'Guardar', class: 'btn btn-primary' %>
        </div>
      </div>
    <% end %>
  </div>
</div>
