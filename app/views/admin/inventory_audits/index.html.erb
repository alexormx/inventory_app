<h1>Auditoría de Inventario</h1>
<p>Herramientas para reconciliar piezas con líneas de Purchase Orders.</p>

<div class="card mb-3">
  <div class="card-header">Reconciliación</div>
  <div class="card-body">
    <p class="text-muted small">Ejecuta en modo <strong>dry-run</strong> primero para revisar impacto. Usa los modos para limitar la acción.</p>
    <div class="d-flex flex-wrap gap-2">
      <%= button_to 'Dry Run (all)', admin_inventory_reconciliations_path(mode: 'all', dry_run: '1'), method: :post, class: 'btn btn-outline-primary btn-sm' %>
      <%= button_to 'Dry Run (orphans)', admin_inventory_reconciliations_path(mode: 'orphans', dry_run: '1'), method: :post, class: 'btn btn-outline-warning btn-sm' %>
      <%= button_to 'Dry Run (missing)', admin_inventory_reconciliations_path(mode: 'missing', dry_run: '1'), method: :post, class: 'btn btn-outline-info btn-sm' %>
      <%= button_to 'Aplicar (all)', admin_inventory_reconciliations_path(mode: 'all'), method: :post, class: 'btn btn-primary btn-sm',
                    data: { controller: 'confirm', action: 'click->confirm#ask', confirm_message: '¿Aplicar reconciliación completa? Esto eliminará huérfanos y creará piezas faltantes.' } %>
      <%= button_to 'Aplicar (solo orphans)', admin_inventory_reconciliations_path(mode: 'orphans'), method: :post, class: 'btn btn-warning btn-sm',
                    data: { controller: 'confirm', action: 'click->confirm#ask', confirm_message: '¿Eliminar huérfanos? Operación irreversible.' } %>
      <%= button_to 'Aplicar (solo missing)', admin_inventory_reconciliations_path(mode: 'missing'), method: :post, class: 'btn btn-success btn-sm',
                    data: { controller: 'confirm', action: 'click->confirm#ask', confirm_message: '¿Crear piezas faltantes? Verifica antes en dry-run.' } %>
    </div>
  </div>
</div>

<p class="small text-muted mb-0">Los resultados aparecen como flash messages y los eventos se registran en <%= link_to 'Inventory Events', admin_inventory_events_path %>.</p>
