<% rel ||= @rel %>
<% rows ||= @rows %>
<% period ||= @period %>
<% page_num = (rel&.current_page || 1).to_i %>
<% per_page = (rel&.limit_value || (rows&.size || 10)).to_i %>
<div class="table-responsive dashboard-scroll">
  <table class="table table-sm mb-0">
    <thead>
      <tr>
        <th scope="col">Rank</th>
        <th scope="col">Producto</th>
        <th scope="col" class="text-end">Unidades</th>
        <th scope="col" class="text-end">Ingresos</th>
      </tr>
    </thead>
    <tbody>
  <% if rows.present? %>
    <% rows.each_with_index do |r, idx| %>
          <tr>
      <td class="text-muted">#<%= ((page_num - 1) * per_page) + idx + 1 %></td>
            <td>
              <div class="small fw-semibold"><%= link_to r[:name], edit_admin_product_path(r[:product_id]) %></div>
              <% if r[:brand].present? || r[:category].present? %>
                <div class="text-muted" style="font-size: .75rem;">(<%= [r[:brand], r[:category]].compact.join(' - ') %>)</div>
              <% end %>
            </td>
            <td class="text-end"><%= number_with_delimiter(r[:units]) %></td>
            <td class="text-end">$ <%= number_with_precision(r[:revenue], precision: 2, delimiter: ',') %></td>
          </tr>
        <% end %>
      <% else %>
        <% if rel.present? %>
          <tr>
            <td colspan="4" class="text-center text-muted py-3">Sin datos</td>
          </tr>
        <% else %>
          <% 3.times do %>
            <tr class="placeholder-row">
              <td colspan="4" class="placeholder-glow"><span class="placeholder col-12"></span></td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>
<% if rel && rel.respond_to?(:current_page) %>
  <div class="px-3 py-2 d-flex justify-content-between align-items-center">
    <div class="small text-muted">Página <%= rel.current_page %> de <%= rel.total_pages %> · <%= rel.total_count %> items</div>
    <nav aria-label="Paginación sellers">
      <ul class="pagination pagination-sm mb-0">
        <% prev_params = request.query_parameters.merge(page: rel.prev_page, period: period, per: rel.limit_value) %>
        <% next_params = request.query_parameters.merge(page: rel.next_page, period: period, per: rel.limit_value) %>
        <li class="page-item <%= 'disabled' unless rel.prev_page %>">
          <%= link_to 'Anterior', admin_dashboard_sellers_path(prev_params), data: { turbo_frame: "frame-sellers-#{period}" }, class: 'page-link' %>
        </li>
        <li class="page-item <%= 'disabled' unless rel.next_page %>">
          <%= link_to 'Siguiente', admin_dashboard_sellers_path(next_params), data: { turbo_frame: "frame-sellers-#{period}" }, class: 'page-link' %>
        </li>
      </ul>
    </nav>
  </div>
<% end %>
