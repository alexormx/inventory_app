<turbo-frame id="inventory-summary-<%= product.id %>">
  <div class="card-body py-2">
    <%# Calcula los conteos por status usando los registros ya cargados para evitar consultas extra %>
    <% counts = product.inventories.group_by(&:status).transform_values(&:size) %>

  <% statuses = ["available", "reserved", "in_transit", "sold", "damaged", "lost", "returned", "scrap"] %>

    <div class="d-flex flex-wrap gap-2 small">
      <% statuses.each do |key| %>
        <% count = counts[key] || 0 %>
        <% next if count == 0 %>
        <span class="badge rounded-pill bg-<%= inventory_status_color(key) %>" title="<%= inventory_status_label(key) %>">
          <%= inventory_status_label(key) %> <span class="ms-1 fw-bold"><%= count %></span>
        </span>
      <% end %>
      <% total = product.inventories.size %>
      <span class="badge rounded-pill bg-secondary" title="Total">
        Total <span class="ms-1 fw-bold"><%= total %></span>
      </span>
    </div>
  </div>
</turbo-frame>