<div id="products_section">
<div class="mb-2 d-flex gap-2 flex-wrap">
  <% label = case (local_assigns[:current_tab].to_s)
            when 'draft' then 'Total Draft'
            when 'inactive' then 'Total Inactive'
            else 'Total Active' end %>
  <span class="badge bg-secondary"><%= label %>: <%= products.respond_to?(:total_count) ? products.total_count : products.count %></span>
  <span class="badge bg-dark">Total global: <%= defined?(total_products_all) ? total_products_all : (defined?(Product) ? Product.count : products.count) %></span>
  <%# Nota: si prefieres evitar consultas en la vista, podemos pasar total_products_all desde el controlador. %>
  
  </div>
  <div class="row g-3">
  <% products.each do |product| %>
    <div class="col-md-6 col-lg-4">
  <%= render partial: 'product_card', locals: { product: product, current_tab: (local_assigns[:current_tab] || 'active') } %>
    </div>
  <% end %>
  </div>
  <div class="d-flex justify-content-center mt-4">
    <%= paginate products %>
  </div>
</div>
